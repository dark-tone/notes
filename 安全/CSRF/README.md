# 概念
跨站请求攻击，简单地说，是攻击者通过一些技术手段欺骗用户的浏览器去访问一个自己曾经认证过的网站并运行一些操作（如发邮件，发消息，甚至财产操作如转账和购买商品）。由于浏览器曾经认证过，所以被访问的网站会认为是真正的用户操作而去运行。这利用了web中用户身份验证的一个漏洞：**简单的身份验证只能保证请求发自某个用户的浏览器，却不能保证请求本身是用户自愿发出的**。

# 流程示例
1. 用户C打开浏览器，访问受信任网站A，输入用户名和密码请求登录网站A；
2. 在用户信息通过验证后，网站A产生Cookie信息并返回给浏览器，此时用户登录网站A成功，可以正常发送请求到网站A；
3. 用户未退出网站A之前，在同一浏览器中，打开一个TAB页访问网站B；
4. 网站B接收到用户请求后，返回一些攻击性代码，并发出一个请求要求访问第三方站点A；
5. 浏览器在接收到这些攻击性代码后，根据网站B的请求，在用户不知情的情况下携带Cookie信息，向网站A发出请求。网站A并不知道该请求其实是由B发起的，所以会根据用户C的Cookie信息以C的权限处理该请求，导致来自网站B的恶意代码被执行。 

# 防御策略
## 验证Referer头部
Referer头部用于表明请求的来源地址，验证该头部是否是本网站域名来防止CSRF攻击。

#### 缺点
Referer头部是由浏览器提供的，不能保证浏览器不会出现安全漏洞，特别是低版本的浏览器。

## 请求参数中加入token
token由服务器生成提供给前端，前端在请求时加上对应的token参数。

#### 缺点
还是可能会被窃取到token。

## 请求自定义头部加入token
使用自定义头部来传输token

## Cookie的SameSite设为Lax
SameSite属性可以控制Cookie在第三方网站时不发送Cookie

# 参考资料
[CSRF攻击与防御](https://blog.csdn.net/stpeace/article/details/53512283)